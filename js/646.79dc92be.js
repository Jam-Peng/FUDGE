"use strict";(self["webpackChunkfudge"]=self["webpackChunkfudge"]||[]).push([[646],{3318:function(e,t,o){o.d(t,{Z:function(){return b}});var a=o(3396),n=o(7139),l=o(9242);const s={"aria-label":"Page navigation example "},i={class:"pagination justify-content-center mt-4"},d=(0,a._)("span",{"aria-hidden":"true"},"«",-1),p=[d],u=["onClick"],c=(0,a._)("span",{"aria-hidden":"true"},"»",-1),r=[c];function m(e,t,o,d,c,m){return(0,a.wg)(),(0,a.iD)("nav",s,[(0,a._)("ul",i,[(0,a._)("li",{class:(0,n.C_)(["page-item",{disabled:!1===o.pages.has_pre}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,l.iM)((e=>m.prePage(o.pages.current_page-1)),["prevent"]))},p)],2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.pages.total_pages,(e=>((0,a.wg)(),(0,a.iD)("li",{class:(0,n.C_)(["page-item",{active:e===o.pages.current_page}]),key:e},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,l.iM)((t=>m.updatePage(e)),["prevent"])},(0,n.zw)(e),9,u)],2)))),128)),(0,a._)("li",{class:(0,n.C_)(["page-item",{disabled:!1===o.pages.has_next}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,l.iM)((e=>m.nextPage(o.pages.current_page+1)),["prevent"]))},r)],2)])])}var h={props:["pages"],emits:["emitPage","emitPre","emitNext"],methods:{updatePage(e){this.$emit("emitPage",e)},prePage(e){this.$emit("emitPre",e)},nextPage(e){this.$emit("emitNext",e)}}},_=o(89);const g=(0,_.Z)(h,[["render",m]]);var b=g},4646:function(e,t,o){o.r(t),o.d(t,{default:function(){return pe}});var a=o(3396),n=o(7139);const l={class:"shadow-sm p-3 mt-2 bg-body rounded"},s={class:"d-flex justify-content-between px-3"},i=(0,a._)("p",{class:"fs-3"},"優惠卷管理表",-1),d={class:"table mt-2 align-middle"},p=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{width:"70",class:"text-center"},"品項"),(0,a._)("th",{width:"200"},"名稱"),(0,a._)("th",null,"折扣百分比"),(0,a._)("th",null,"到期日"),(0,a._)("th",null,"是否啟用"),(0,a._)("th",null,"編輯")])],-1),u={class:"text-center"},c={key:0,class:"text-success"},r={key:1,class:"text-muted"},m={class:"btn-group"},h=["onClick"],_=["onClick"];function g(e,t,o,g,b,C){const v=(0,a.up)("OverLoading"),f=(0,a.up)("CouponModal"),w=(0,a.up)("DeleteCouponModal"),y=(0,a.up)("PagiNation");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(v,{active:b.isLoading},null,8,["active"]),(0,a._)("div",l,[(0,a._)("div",null,[(0,a._)("div",s,[i,(0,a._)("span",null,[(0,a._)("button",{class:"btn btn-primary mt-1",type:"button",onClick:t[0]||(t[0]=e=>C.openModal(!0))}," 新增優惠卷 ")])]),(0,a._)("table",d,[p,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.coupons,((t,o)=>((0,a.wg)(),(0,a.iD)("tr",{key:o},[(0,a._)("td",u,(0,n.zw)(o+1),1),(0,a._)("td",null,(0,n.zw)(t.title),1),(0,a._)("td",null,(0,n.zw)(t.percent)+"%",1),(0,a._)("td",null,(0,n.zw)(e.$filters.date(t.due_date)),1),(0,a._)("td",null,[t.is_enabled?((0,a.wg)(),(0,a.iD)("span",c,"啟用")):((0,a.wg)(),(0,a.iD)("span",r,"不啟用"))]),(0,a._)("td",null,[(0,a._)("div",m,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>C.openModal(!1,t)}," 編輯 ",8,h),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>C.openDeleteCoupon(t)}," 刪除 ",8,_)])])])))),128))])])])]),(0,a.Wm)(f,{ref:"CouponModal",coupon:b.tempCoupon,onUpdateCoupon:C.updateCoupon},null,8,["coupon","onUpdateCoupon"]),(0,a.Wm)(w,{ref:"DeleteCouponModal",coupon:b.tempCoupon,onDelCoupon:C.DeleteCoupon},null,8,["coupon","onDelCoupon"]),(0,a.Wm)(y,{pages:b.pagination,onEmitPage:C.getCoupons,onEmitPre:C.getCoupons,onEmitNext:C.getCoupons},null,8,["pages","onEmitPage","onEmitPre","onEmitNext"])],64)}var b=o(9242);const C={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},v={class:"modal-dialog modal-md",role:"document"},f={class:"modal-content"},w=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a._)("span",null,"優惠卷資料")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),y={class:"modal-body"},x={class:"mb-3"},k=(0,a._)("label",{for:"title"},"標題",-1),M={class:"mb-3"},D=(0,a._)("label",{for:"coupon_code"},"優惠碼",-1),P={class:"mb-3"},$=(0,a._)("label",{for:"due_date"},"到期日",-1),N={class:"mb-3"},U=(0,a._)("label",{for:"price"},"折扣百分比",-1),Z={class:"mb-3"},L={class:"form-check"},z=(0,a._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),E={class:"modal-footer"},V=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);function W(e,t,o,n,l,s){return(0,a.wg)(),(0,a.iD)("div",C,[(0,a._)("div",v,[(0,a._)("div",f,[w,(0,a._)("div",y,[(0,a._)("div",x,[k,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":t[0]||(t[0]=e=>l.tempCoupon.title=e)},null,512),[[b.nr,l.tempCoupon.title,void 0,{trim:!0}]])]),(0,a._)("div",M,[D,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"coupon_code",placeholder:"請輸入優惠碼","onUpdate:modelValue":t[1]||(t[1]=e=>l.tempCoupon.code=e)},null,512),[[b.nr,l.tempCoupon.code,void 0,{trim:!0}]])]),(0,a._)("div",P,[$,(0,a.wy)((0,a._)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=e=>l.due_date=e)},null,512),[[b.nr,l.due_date]])]),(0,a._)("div",N,[U,(0,a.wy)((0,a._)("input",{type:"number",class:"form-control",id:"price",placeholder:"請輸入折扣百分比","onUpdate:modelValue":t[3]||(t[3]=e=>l.tempCoupon.percent=e)},null,512),[[b.nr,l.tempCoupon.percent,void 0,{Number:!0}]])]),(0,a._)("div",Z,[(0,a._)("div",L,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=e=>l.tempCoupon.is_enabled=e)},null,512),[[b.e8,l.tempCoupon.is_enabled]]),z])])]),(0,a._)("div",E,[V,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=t=>e.$emit("updateCoupon",l.tempCoupon))}," 更新優惠券 ")])])])],512)}var H=o(1339),T={data(){return{modal:{},tempCoupon:{},due_date:""}},props:{coupon:{}},emits:["updateCoupon"],watch:{coupon(){this.tempCoupon={...this.coupon};const e=new Date(1e3*(this.tempCoupon.due_date+28800)).toISOString().split("T");[this.due_date]=e},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},mixins:[H.Z]},Y=o(89);const j=(0,Y.Z)(T,[["render",W]]);var K=j;const O={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},S={class:"modal-dialog",role:"document"},I={class:"modal-content border-0"},q={class:"modal-header bg-danger text-white"},A={class:"modal-title"},B=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),F={class:"modal-body"},G=(0,a.Uk)(" 是否刪除 "),J={class:"text-danger"},Q=(0,a.Uk)(" (刪除後將無法恢復)。 "),R={class:"modal-footer"},X=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ee(e,t,o,l,s,i){return(0,a.wg)(),(0,a.iD)("div",O,[(0,a._)("div",S,[(0,a._)("div",I,[(0,a._)("div",q,[(0,a._)("h5",A,[(0,a._)("span",null,"刪除 "+(0,n.zw)(o.coupon.title),1)]),B]),(0,a._)("div",F,[G,(0,a._)("strong",J,(0,n.zw)(o.coupon.title),1),Q]),(0,a._)("div",R,[X,(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=t=>e.$emit("del-Coupon"))}," 確認刪除 ")])])])],512)}var te={data(){return{modal:{}}},props:["coupon"],emits:["del-Coupon"],mixins:[H.Z]};const oe=(0,Y.Z)(te,[["render",ee]]);var ae=oe,ne=o(3318),le=o(9233),se=o(3766),ie={data(){return{coupons:[],pagination:{},tempCoupon:{},isNew:!1,isLoading:!1}},components:{CouponModal:K,DeleteCouponModal:ae,PagiNation:ne.Z},methods:{...(0,se.nv)(le.Z,["pushMessage"]),getCoupons(e){const t=`https://vue3-course-api.hexschool.io/api/pengplan-api/admin/coupons?page=${e}`;this.isLoading=!0,this.$http.get(t).then((e=>{setTimeout((()=>{this.isLoading=!1}),500),e.data.success&&(this.coupons=e.data.coupons,this.pagination=e.data.pagination)})).catch((e=>{console.log(e.response)}))},openModal(e,t){this.tempCoupon=e?{due_date:(new Date).getTime()/1e3}:{...t},this.isNew=e,this.$refs.CouponModal.showModel()},updateCoupon(e){this.tempCoupon=e;let t="https://vue3-course-api.hexschool.io/api/pengplan-api/admin/coupon",o="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/api/pengplan-api/admin/coupon/${e.id}`,o="put"),this.$http[o](t,{data:this.tempCoupon}).then((e=>{this.$refs.CouponModal.hideModal(),this.getCoupons(),this.pushMessage(e.data.success,"更新優惠卷",e.data.message)})).catch((e=>{console.log(e.response)}))},openDeleteCoupon(e){this.tempCoupon=e,this.$refs.DeleteCouponModal.showModel()},DeleteCoupon(){const e=`https://vue3-course-api.hexschool.io/api/pengplan-api/admin/coupon/${this.tempCoupon.id}`;this.$http.delete(e).then((e=>{this.$refs.DeleteCouponModal.hideModal(),this.getCoupons(),this.pushMessage(e.data.success,"刪除優惠卷",e.data.message)})).catch((e=>{console.log(e.response)}))}},created(){this.getCoupons()}};const de=(0,Y.Z)(ie,[["render",g]]);var pe=de}}]);
//# sourceMappingURL=646.79dc92be.js.map